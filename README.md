#Loadshape
*A Python module containing tools for analyzing electric load shapes*


Generating baselines for electric loads can be tricky, this module makes it easy:

```
#!python
from loadshape import Loadshape

# electric load data - values are expected to be power (kW)
load_data = [ ("2013-08-01 00:00:00", 5.168),
              ("2013-08-01 00:15:00", 6.235),
              ("2013-08-01 00:30:00", 5.021),
              ...,
              ("2013-09-26 23:45:00", 4.739) ]

my_loadshape = Loadshape(load_data, timezone="America/Los_Angeles")
my_baseline = my_loadshape.baseline()
```

##Installation
To install using pip:
```sh
pip install git+https://bitbucket.org/berkeleylab/eetd-loadshape.git@master
```

##Dependencies
The loadshape module depends on R, and the 'optparse' R module

Install R using homebrew on OSX:
```sh
brew install R
```

[Install R using apt on Ubuntu](http://cran.r-project.org/bin/linux/ubuntu/README):
```sh
sudo apt-get install r-base-core
```

Once you have R installed, open up an R console and install optparse:
```sh
R
> install.packages("optparse")
# ... follow the instructions
```

Table of Contents:
----
+ **Introduction**
+ **Input Data:**
    + Timestamps
    + Timezones
    + Power Data
    + CSV Inputs
+ **Calculations:**
    + Baselines
    + Measurement and Verification
    + Economic Valuation
+ **Advanced Usage:**
    + Exclusion Periods
    + Outdoor Air Temperature
    + Modeling Interval
    + Weighting
    + Goodness of Fit
    + Tariffs
+ **Examples:**
    + Ex 1: Seven Day Baseline
    + Ex 2: Cumulative Sum
    + Ex 3: DR Event Performance
+ **Contribution**

##Introduction
The loadshape module provides a quick and easy way to generate baselines and calculated quantities that are relevant for comparing actual electric loads with predicted (baseline) electric loads. The statistical model that is used by this module to generate baselines is intended to be used for electric loads that are sensitive to outdoor air temperature and which tend to follow trends based on time-of-week.

The Loadshape class that is provided by this module makes it easy to manage time series electric load data, and exposes a simple interface to several underlying R functions, including the function which fits a statistical model to the input load data for the purposes of generating baselines.

##Input Data
The only input data that the loadshape module requires in order to produce useful baselines is a set of time-series electric load data:

```python
# electric load data should be provided as a List of tuples
load_data = [ ("2013-08-01 00:00:00", 5.168),
              ("2013-08-01 00:15:00", 6.235),
              ("2013-08-01 00:30:00", 5.021),
              ...,
              ("2013-09-26 23:45:00", 4.739) ]

my_loadshape = Loadshape(load_data=load_data)
```

As shown in the example above, the load data should be provided in the form of a Python List containing Tuples with two elements each. The first element of each Tuple shoul be a timestamp, and the second element should be a value representing power (kW).

###Timestamps
For convenience, the timestamps within input data may take several different forms. All of the timestamps below are valid:

```python
valid_load_data = [ ("2013-08-01 00:00:00", 5.168), # string: "YYYY-MM-DD HH:MM:SS"
                    (1375341300, 6.235),            # integer: seconds since Unix epoch
                    (1375342200000, 5.021),         # integer: milliseconds since Unix epoch
                    ("1375343100", 5.046),          # string: seconds since Unix eopoch
                    ...,
                    ("1380264300000", 4.739) ]      # string: milliseconds since Unix epoch
```

###Time Zones
It's important that you specify what timezones your timestamps refer to. If no timezone is specified, then the module will assume that you are using the timezone of your OS, but this isn't necessarily a great assumption. Specify your timezone using the appropriate [timezone name](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones) when you create a new instance of the Loadshape class.
```python
my_loadshape = Loadshape(load_data, timezone="America/Los_Angeles")
```
Using the correct timezone is important because the statistical model used to generate baselines makes some assumptions that depend on its ability to make reasonable assumptions regarding time-of-day and also time-of-week.

###Power Data
As noted above, the values within the provided time-series load data are assumed to prepresent power (kW). If the provided values do not represent kW, the baselines generated by the module may still be reasonable, but the values produced by the event_performance method will be incorrect.

###Outdoor Air Temperature Data
Passing outdoor air temperature data in addition to electric load data will allow the loadshape module to produce much more accurate baselines. Specify the units of the temperature data by setting the temp_units argument to either "C" or "F".
```python
# electric load data - values are expected to be power (kW)
load_data = [ ("2013-08-01 00:00:00", 5.168),
              ("2013-08-01 00:15:00", 6.235),
              ("2013-08-01 00:30:00", 5.021),
              ...,
              ("2013-09-26 23:45:00", 4.739) ]

# outdoor air temperature data
temp_data = [ ("2013-08-01 00:00:00", 54.23),
              ("2013-08-01 01:00:00", 54.60),
              ("2013-08-01 02:00:00", 54.65),
              ...,
              ("2013-09-26 23:45:00", 58.44) ]

my_loadshape = Loadshape(load_data, temp_data, temp_units="F")
```

###CSV Inputs
As an alternative to passing input data to the Loadshape initializer as a List of Tuples, a reference to an appropriately formatted CSV file may be passed instead:
```python
my_loadshape = Loadshape("path/to/load_data.csv", "path/to/temperature_data.csv")
```
The loadshape module expects these CSVs to contain two colums. As with the Tuples, the first element in each column should be a valid timestamp, and the second column should be the corresponding value. Valid timestamps are discussed in the timestamps section above.

##Calculations

###Baselines

###Measurement and Verification

###Economic Valuation

## Advanced usage

###Exclusion Periods

###Prediction Periods

###Outdoor Air Temperature

###Modeling Interval

###Weighting

###Goodness of Fit

###Tariffs

##Examples

###Ex 1: Seven Day Baseline

###Ex 2: Cumulative Sum

###Ex 3: DR Event Performance

##Contribution
Contributions are welcome and encouraged. If you find a bug, please file it. If you would like to see a feature added, please request it. If you would like to contribute code, please fork and submit a pull request.
